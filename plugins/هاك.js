import fetch from 'node-fetch';
import fs from 'fs/promises';

const handler = async (m, { client, usedPrefix, command , isROwner}) => {
  
  if (!isROwner) return;
  let _return;

  try {
    // const configData = await fs.readFile('plugins/config.json', 'utf-8');
    // const config = JSON.parse(configData);

    const config = {
      waitMessages: [
        // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù‡Ù†Ø§
        "â†°  Ø¬Ø§Ø± ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ \n â¬›ï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸ ",
        "â†°  Ø¬Ø§Ø± ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ \n â¬›ï¸ğŸ”³ï¸â¬œï¸â¬œï¸â¬œï¸â¬œï¸ ",
        "â†°  Ø¬Ø§Ø± ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ \n â¬›ï¸â¬›ï¸ğŸ”³ï¸â¬œï¸â¬œï¸â¬œï¸ ",
       "â†°  Ø¬Ø§Ø± ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ \n â¬›ï¸â¬›ï¸â¬›ï¸ï¸ğŸ”³â¬œï¸â¬œï¸ ",     
        "â†°  Ø¬Ø§Ø± ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ \n â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸ğŸ”³â¬œï¸ ",  
        "â†°  Ø¬Ø§Ø± ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ \n â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸ğŸ”³ï¸ ",
        "â†°  Ø¬Ø§Ø± ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ \n â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸ ",
        "â†° ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ø± Ø§Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øªï¸ ",
        "â†° ØªÙ… Ø§Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªÙ†Ø¸ÙŠÙ…Ù‡Ø§ âœ”ï¸ ",      
        "â†° Ø¬Ø§Ø± Ø§Ù„Ø¥ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ø§Ø³Ø§Ø³ÙŠ",
        "â†° ØªÙ… Ø§Ù„Ø¥ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­ âœ…ï¸",
        "â†° Ø¬Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù . ",
        "â†° Ø¬Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù . . ",
        "â†° Ø¬Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù . . . ",
        "â†° Ø¬Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù . ",
        "â†° ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­ âœ…ï¸ ",
        "â†° Ø¬Ø§Ø± Ù†Ø³Ø® Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ù„Ø­ÙØ¸Ù‡Ø§ Ù Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª \nâ—‰ Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ : Ù‚ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ğŸ“",
        "â†° ØªÙ… Ø­ÙØ¸ Ù†Ø³Ø®Ø© Ù…Ù† Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ© ÙˆØ§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø­Ø°ÙˆÙØ© âœ…ï¸\nâ—‰ Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ : Ù‚ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ğŸ“",
        // ...
      ],
    };

    const { key } = await m.reply("starting ....");

    let currentIndex = 0;

    const upm = async () => {
      try {
        const currentTime = new Date().toLocaleTimeString('en-US', {
      timeZone: 'Africa/Cairo',
      hour: '2-digit',
      minute: '2-digit',
    });

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙÙŠ config ÙˆÙˆÙ‚Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        const updatedMessage = `${config.waitMessages[currentIndex]} \nâ—‰ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù : ${m.chat} \nâ—‰ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ :  ${currentTime}`;

        await client.sendMessage(m.chat, { text: `${updatedMessage}`, edit: key }, { quoted: m });

        // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ÙÙ‡Ø±Ø³ Ù„Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (Ø¯ÙˆÙ† Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©)
        currentIndex = (currentIndex + 1) % config.waitMessages.length;

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù†ØªÙ‡Ø§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ­Ø¯ÙŠØ«
        if (currentIndex === 0) {
          clearTimeout(timeoutId);
          return;
        }

        // Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ« ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
        timeoutId = setTimeout(upm, 6000);
      } catch (error) {
        console.error(error);
      }
    };

    let timeoutId;

    upm();
  } catch (error) {
    console.error(error);
  }
};

handler.help = ['fun'];
handler.tags = ['hack'];
handler.private = true;
handler.command = /^(hack)$/i;

export default handler; 